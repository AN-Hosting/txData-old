const _0x56ab26=_0x3fd2;!function(){for(var n=_0x3fd2,e=_0x3216();;)try{if(180966==-parseInt(n(344))*(parseInt(n(289))/2)+parseInt(n(330))/3*(parseInt(n(325))/4)+-parseInt(n(256))/5*(-parseInt(n(280))/6)+-parseInt(n(250))/7+parseInt(n(396))/8*(-parseInt(n(252))/9)+parseInt(n(450))/10+-parseInt(n(337))/11*(-parseInt(n(273))/12))break;e.push(e.shift())}catch(n){e.push(e.shift())}}();import{Post,getOwnedObjects}from"./api.js";import*as _0x31b7bb from"three";import{TransformControls}from"three/addons/controls/TransformControls.js";function _0x3216(){const n=["hash","beKOr","lper #enti","gAypA","WzNLE","eMovement","set","render","prevZ","yqXUa","offsetTop","oFlVI","distance","#object-he","setSize","scale","uawoK","iryVf","ddGXQ","wCtPE","setMode","mouseDown","fov","tor","visible","rytBl","BoxGeometr","change","length","prevRoll","gMpKr","0|4|5|1|2|","aterial","3|2|4|6|5|","exists","eDAfi","|12|4|0","ity","yaw","LGsus","pageY","edit_entit","1096aEzvGs","JKeSv","pMosp","eCamera","sort","zxyII","FVXlN","querySelec","FSjfK","MZhNe","bBcon","categories","toggleCurs","updateProj","tionSnap","rer","lper #mode","rotate","hit","cam","mousemove","ectionMatr","0|5|2|4|1|","mousedown","OJSnI","DxbdG","addEventLi","oCDZc","rotation","Scene","load_entit","pitch","qKoXP","alpha","UrQpm","DpHjC","MvOQb","vClnA","documentEl","setTransla","rbcmH","ty-pitch","scrollWidt","FanZk","val","translate","ty-y","innerWidth","tqrjq","dPmty","mouseUp","FwsAs","appendChil","veEdD","405860PTdOoN","wROzH","split","keydown","setRotatio","ngsYJ","target","CjdpX","ect","XVyQC","73031FGnPIY","rnXue","16902oSNRPh","14|13|3|7|","push","aoqet","73555hVfxZE","domElement","sortingMen","Klbzq","none","stener","scrollHeig","PYgMs","0|4|1|2|3","toggleMous","wFrJF","bVEQx","stash","|6|2|8|9|1","#decorate","ement","VPren","36cPpcuO","y_info","YZX","innerHeigh","YZdBP","LosoN","l-name","114vJvgar","ETZpp","Fokxi","IiApP","position","uUSwu","1|0","entity","OnDNp","214GIRRCy","attach","shMxc","PADdx","key","KQjlU","ydHpU","Perspectiv","JzJcq","ty-yaw","ZmyZQ","ty-x","hAqKl","ty-z","UiWii","ThUwS","NqHbj","prevX","ty-roll","cxJZE","CFKtf","select_ent","add","YOVso","15|11|5|10","RDmEm","yWyrc","roll","hofso","abLdp","block","GoNdq","MeshPhongM","rhHMI","yGjhb","nSnap","4sjNyxe","Mesh","Wawkb","handle","prevYaw","141294ulPvJQ","ewDuW","mTvSY","woBFY","display","order","rfSiT","1380467fUHCoe","Okgcz","pageX","prevY","xsBqS","ground_obj","VlBlU","2757ujnjkt","WebGLRende","Lsvcz","tagName","style","Wfrxk","prevPitch","MraJF","CANVAS","Pyrrp"];return(_0x3216=function(){return n})()}let decorateMenu=null,editable=!1,editingData={};function setDecorateMenu(n){decorateMenu=n}const tracking={x:0,y:0},objectInfos={},furniData={prevY:[],prevX:[],prevZ:[],prevPitch:[],prevRoll:[],prevYaw:[]};let isTransforming=!1,editingId=null;const degToRad=n=>{var e=_0x3fd2,t={ydHpU:function(n,e){return n*e},JKeSv:function(n,e){return n/e}};return t[e(295)](n,t[e(397)](Math.PI,180))},radToDeg=n=>{var e=_0x3fd2,t={OnDNp:function(n,e){return n*e},zxyII:function(n,e){return n/e}};return t[e(288)](n,t[e(401)](180,Math.PI))},selectLegacyObject=async n=>{var e=_0x3fd2,t={XVyQC:function(n,e){return n!=e},wROzH:function(n,e){return n==e},VPren:function(n){return n()},KQjlU:function(n,e){return n<e},FanZk:function(n,e){return n==e}};if(t[e(249)](decorateMenu,null)&&t[e(451)](decorateMenu[e(400)],2)){var r=await t[e(272)](getOwnedObjects);if(!t[e(451)](r[decorateMenu[e(407)][e(258)+"u"][e(268)]][e(328)],n)){for(var a=null,o=0;t[e(294)](o,r[e(382)]);o++)if(t[e(439)](r[o][e(328)],n)){a=o;break}t[e(249)](a,null)&&(decorateMenu[e(407)][e(258)+"u"][e(268)]=a),decorateMenu[e(407)][e(258)+"u"][e(400)]()}}},mouseDownHandler=async n=>{var e=_0x3fd2,t={VlBlU:function(n,e){return n&&e},shMxc:function(n,e){return n!==e},rhHMI:e(352),MraJF:function(n,e,t){return n(e,t)},DpHjC:e(310)+e(391),ngsYJ:function(n,e){return n!=e},IiApP:function(n,e){return n==e},oFlVI:function(n){return n()},qKoXP:function(n,e){return n<e},eDAfi:function(n,e){return n==e},FVXlN:function(n,e){return n(e)},gMpKr:e(264),aoqet:function(n,e){return n==e}};if(!(isTransforming=!t[e(343)](isTransforming,!editingId)&&isTransforming)&&!t[e(291)](n[e(456)][e(347)],t[e(322)])){var n=tracking.x,r=tracking.y,a=await t[e(351)](Post,t[e(431)],{x:n,y:r});if(a[e(414)]&&t[e(291)](editingId,a[e(287)]))if(t[e(455)](decorateMenu,null)&&t[e(283)](decorateMenu[e(400)],2)){var o=await t[e(365)](getOwnedObjects);if(!t[e(283)](o[decorateMenu[e(407)][e(258)+"u"][e(268)]][e(328)],a[e(287)])){for(var i=null,s=0;t[e(428)](s,o[e(382)]);s++)if(t[e(389)](o[s][e(328)],a[e(287)])){i=s;break}t[e(455)](i,null)&&(decorateMenu[e(407)][e(258)+"u"][e(268)]=i),decorateMenu[e(407)][e(258)+"u"][e(400)]()}}else t[e(365)](clearData),editingId=a[e(287)],t[e(402)](changeEntity,editingId),isTransforming=!1;else if(!a[e(414)]){var c=t[e(384)][e(452)]("|");let n=0;for(;;){switch(c[n++]){case"0":if(t[e(455)](decorateMenu,null)&&t[e(255)](decorateMenu[e(400)],2))return;continue;case"1":editingId=null;continue;case"2":transformControls[e(378)]=!1;continue;case"3":isTransforming=!1;continue;case"4":t[e(365)](clearData);continue}break}}}},handleTracking=(window[_0x56ab26(422)+_0x56ab26(261)](_0x56ab26(419),mouseDownHandler),n=>{var e=_0x56ab26,t={ddGXQ:function(n,e){return n-e},uawoK:function(n,e,t){return n(e,t)},Wawkb:function(n,e,t){return n(e,t)}},r=t[e(372)](n[e(339)],n[e(456)][e(364)]),n=t[e(372)](n[e(394)],n[e(456)][e(364)]);tracking.x=t[e(370)](normalize,r,document[e(434)+e(271)][e(438)+"h"]),tracking.y=t[e(327)](normalize,n,document[e(434)+e(271)][e(262)+"ht"])}),Scene=new _0x31b7bb[_0x56ab26(425)],Renderer=new _0x31b7bb[_0x56ab26(345)+_0x56ab26(411)]({alpha:!0}),Camera=(Renderer[_0x56ab26(368)](window[_0x56ab26(443)],window[_0x56ab26(276)+"t"]),document[_0x56ab26(403)+_0x56ab26(377)](_0x56ab26(270))[_0x56ab26(448)+"d"](Renderer[_0x56ab26(257)]),new _0x31b7bb[_0x56ab26(296)+_0x56ab26(399)](50,window[_0x56ab26(443)]/window[_0x56ab26(276)+"t"],.1,1e4)),boxGeometry=(Camera[_0x56ab26(424)][_0x56ab26(335)]=_0x56ab26(275),new _0x31b7bb[_0x56ab26(380)+"y"](1,1,1)),meshPhongMaterial=new _0x31b7bb[_0x56ab26(321)+_0x56ab26(386)]({color:16711935,transparent:!0,opacity:0}),Mesh=new _0x31b7bb[_0x56ab26(326)](boxGeometry,meshPhongMaterial);function _0x3fd2(n,e){const t=_0x3216();return(_0x3fd2=function(n,e){return n-=249,t[n]})(n,e)}Mesh[_0x56ab26(424)][_0x56ab26(335)]=_0x56ab26(275),Mesh[_0x56ab26(369)][_0x56ab26(360)](1,1,1),Scene[_0x56ab26(311)](Mesh),Renderer[_0x56ab26(257)][_0x56ab26(348)][_0x56ab26(334)]=_0x56ab26(260);let animationFrameActive=null;function renderGeometry(){var n=_0x56ab26;animationFrameActive={rnXue:function(n,e){return n(e)}}[n(251)](requestAnimationFrame,renderGeometry),Renderer[n(361)](Scene,Camera)}function showGeometry(){var n=_0x56ab26,e={bBcon:n(319)};transformControls[n(378)]=!1,Renderer[n(257)][n(348)][n(334)]=e[n(406)]}function hideGeometry(){var n=_0x56ab26,e={PADdx:n(260)};transformControls[n(378)]=!1,Renderer[n(257)][n(348)][n(334)]=e[n(292)]}function hideTransformControls(){var n=_0x56ab26;transformControls[n(378)]=!1}const transformControls=new TransformControls(Camera,Renderer[_0x56ab26(257)]),editEntity=(transformControls[_0x56ab26(422)+_0x56ab26(261)](_0x56ab26(381),()=>{var n=_0x56ab26,e={PYgMs:function(n,e){return n(e)},iryVf:function(n,e){return n(e)},MZhNe:function(n,e){return n(e)},LosoN:function(n){return n()}},t=objectInfos[editingId];Mesh[n(284)].x&&Mesh[n(284)].y&&Mesh[n(284)].z&&t&&(t.x=Mesh[n(284)].x,t.y=-Mesh[n(284)].z,t.z=Mesh[n(284)].y,t[n(427)]=e[n(263)](radToDeg,Mesh[n(424)].x),t[n(316)]=e[n(371)](radToDeg,-Mesh[n(424)].z),t[n(392)]=e[n(405)](radToDeg,Mesh[n(424)].y),e[n(278)](editEntity),Renderer[n(361)](Scene,Camera))}),()=>{var n=_0x56ab26,e={hAqKl:function(n,e,t){return n(e,t)},CjdpX:n(395)+"y",gAypA:function(n,e){return n(e)},rbcmH:function(n,e){return n(e)},tqrjq:function(n,e){return n(e)}},t=objectInfos[editingId];e[n(301)](Post,e[n(457)],{id:editingId,alpha:e[n(357)](parseInt,t[n(429)]),x:e[n(357)](parseFloat,t.x),y:e[n(357)](parseFloat,t.y),z:e[n(436)](parseFloat,t.z),pitch:e[n(357)](parseFloat,t[n(427)]),roll:e[n(357)](parseFloat,t[n(316)]),yaw:e[n(436)](parseFloat,t[n(392)])}),e[n(444)](setObjectHelperValues,t)}),storeData=(transformControls[_0x56ab26(422)+_0x56ab26(261)](_0x56ab26(375),()=>{var n=_0x56ab26;isTransforming=!0,{rytBl:function(n){return n()}}[n(379)](storeData)}),transformControls[_0x56ab26(422)+_0x56ab26(261)](_0x56ab26(446),()=>{var n=_0x56ab26,e=objectInfos[editingId];e&&(e.x=Mesh[n(284)].x,e.y=-Mesh[n(284)].z,e.z=Mesh[n(284)].y,isTransforming=!1)}),transformControls[_0x56ab26(435)+_0x56ab26(410)](.1),transformControls[_0x56ab26(368)](.8),transformControls[_0x56ab26(454)+_0x56ab26(324)](degToRad(15)),transformControls[_0x56ab26(290)](Mesh),Scene[_0x56ab26(311)](transformControls),()=>{var e=_0x56ab26,t={Fokxi:function(n,e){return n!==e},Pyrrp:function(n,e){return n!==e},wCtPE:e(418)+"3"},r=objectInfos[editingId];if(r&&t[e(282)](r.x,0)&&t[e(282)](r.y,0)&&t[e(353)](r.z,0)){var a=t[e(373)][e(452)]("|");let n=0;for(;;){switch(a[n++]){case"0":furniData[e(306)][e(254)](r.x);continue;case"1":furniData[e(383)][e(254)](r[e(316)]);continue;case"2":furniData[e(362)][e(254)](r.z);continue;case"3":furniData[e(329)][e(254)](r[e(392)]);continue;case"4":furniData[e(350)][e(254)](r[e(427)]);continue;case"5":furniData[e(340)][e(254)](r.y);continue}break}}});function cancelRenderGeometry(){var n=_0x56ab26;animationFrameActive&&({NqHbj:function(n,e){return n(e)}}[n(305)](cancelAnimationFrame,animationFrameActive),animationFrameActive=null)}function setEditMode(n){var e=_0x56ab26,t={JzJcq:function(n,e){return n===e},pMosp:e(413),UrQpm:e(441)};t[e(297)](n,t[e(398)])?transformControls[e(374)](t[e(398)]):transformControls[e(374)](t[e(430)])}function setRotationSnap(n){var e=_0x56ab26;transformControls[e(454)+e(324)](n)}function setTranslationSnap(n){var e=_0x56ab26;transformControls[e(435)+e(410)](n)}const normalize=(n,e)=>{var t=_0x56ab26,r={ThUwS:function(n,e){return n+e},FSjfK:function(n,e){return n/e},bVEQx:function(n,e){return n*e},hofso:function(n,e){return n-e}};return r[t(304)](r[t(404)](r[t(267)](1,r[t(317)](n,0)),r[t(317)](e,0)),0)},handleUpdatePositions=(window[_0x56ab26(422)+_0x56ab26(261)](_0x56ab26(416),handleTracking),n=>{var e=_0x56ab26,t={Okgcz:function(n,e){return n(e)},wFrJF:function(n,e){return n(e)},FwsAs:function(n,e,t){return n(e,t)}},r=(Camera[e(284)][e(360)](n[e(415)][e(284)].x,n[e(415)][e(284)].z,-n[e(415)][e(284)].y),n[e(415)][e(424)].x),a=n[e(415)][e(424)].z,o=n[e(415)][e(424)].y;Camera[e(424)][e(360)](t[e(338)](degToRad,r),t[e(266)](degToRad,t[e(447)](zRotationHandler,r,a)),t[e(266)](degToRad,o)),Camera[e(376)]=n[e(415)][e(376)],Camera[e(409)+e(417)+"ix"](),n[e(287)][e(284)]&&(Mesh[e(284)][e(360)](n[e(287)][e(284)].x,n[e(287)][e(284)].z,-n[e(287)][e(284)].y),Mesh[e(424)][e(360)](t[e(338)](degToRad,n[e(287)][e(424)].x),t[e(338)](degToRad,n[e(287)][e(424)].z),t[e(338)](degToRad,-n[e(287)][e(424)].y)))}),changeEntity=async n=>{var e=_0x56ab26,t={ETZpp:function(n,e,t){return n(e,t)},Lsvcz:e(426)+e(274),WzNLE:function(n,e){return n(e)},DxbdG:function(n,e){return n(e)}},n=await t[e(281)](Post,t[e(346)],{id:t[e(358)](parseInt,n)});t[e(421)](setEntityData,n)},zRotationHandler=(n,e)=>{var t=_0x56ab26,r={CFKtf:function(n,e){return e<n},abLdp:function(n,e){return n<e},uUSwu:function(n,e){return e<n}};return(!r[t(309)](n,0)||!r[t(318)](n,90))&&(r[t(309)](n,-180)&&r[t(318)](n,-90)||r[t(285)](n,0))?-e:e},setEntityData=n=>{var e=_0x56ab26,t={vClnA:e(253)+e(313)+e(269)+e(390),ewDuW:function(n,e){return n(e)},yGjhb:function(n,e){return n!==e},MvOQb:function(n){return n()}},r=t[e(433)][e(452)]("|");let a=0;for(;;){switch(r[a++]){case"0":t[e(331)](setObjectHelperValues,n);continue;case"1":editingData[e(392)]=n[e(392)];continue;case"2":editingData.z=n.z;continue;case"3":editable=!0;continue;case"4":transformControls[e(378)]=!0;continue;case"5":editingData[e(429)]=n[e(429)];continue;case"6":editingData.y=n.y;continue;case"7":editingId=n.id;continue;case"8":editingData[e(427)]=n[e(427)];continue;case"9":editingData[e(316)]=n[e(316)];continue;case"10":editingData.x=n.x;continue;case"11":editingData[e(354)]=n[e(354)];continue;case"12":editingData[e(366)]=n[e(366)];continue;case"13":t[e(323)](editingId,n.id)&&t[e(432)](clearData);continue;case"14":if(n[e(388)])continue;return editable=!1,void(transformControls[e(378)]=!1);case"15":objectInfos[editingId]={id:n.id,hash:n[e(354)],alpha:n[e(429)],x:n.x,y:n.y,z:n.z,pitch:n[e(427)],roll:n[e(316)],yaw:n[e(392)],distance:n[e(366)],quaternion:{}};continue}break}},setObjectHelperValues=n=>{var e=_0x56ab26,t={mTvSY:e(387)+e(286),woBFY:function(n,e){return n(e)},OJSnI:e(367)+e(356)+e(298),RDmEm:function(n,e){return n(e)},yWyrc:e(367)+e(356)+e(307),GoNdq:e(367)+e(356)+e(300),YOVso:e(367)+e(412)+e(279),ZmyZQ:function(n,e){return n(e)},beKOr:e(367)+e(356)+e(442),UiWii:function(n,e){return n(e)},yqXUa:e(367)+e(356)+e(437),dPmty:e(367)+e(356)+e(302)},r=t[e(332)][e(452)]("|");let a=0;for(;;){switch(r[a++]){case"0":t[e(333)]($,t[e(420)])[e(440)](n[e(392)]);continue;case"1":t[e(314)]($,t[e(315)])[e(440)](n[e(316)]);continue;case"2":t[e(333)]($,t[e(320)])[e(440)](n.x);continue;case"3":t[e(314)]($,t[e(312)])[e(440)](n[e(354)]);continue;case"4":t[e(299)]($,t[e(355)])[e(440)](n.y);continue;case"5":t[e(303)]($,t[e(363)])[e(440)](n[e(427)]);continue;case"6":t[e(299)]($,t[e(445)])[e(440)](n.z);continue}break}},clearData=()=>{var n=_0x56ab26,e={Klbzq:n(385)+"3"}[n(259)][n(452)]("|");let t=0;for(;;){switch(e[t++]){case"0":furniData[n(340)]=[];continue;case"1":furniData[n(350)]=[];continue;case"2":furniData[n(383)]=[];continue;case"3":furniData[n(329)]=[];continue;case"4":furniData[n(306)]=[];continue;case"5":furniData[n(362)]=[];continue}break}};window[_0x56ab26(422)+_0x56ab26(261)](_0x56ab26(453),async n=>{var e=_0x56ab26,t={oCDZc:function(n,e){return n===e},YZdBP:function(n,e){return n(e)},rfSiT:e(265)+e(359),xsBqS:e(408)+"or",veEdD:function(n,e){return n===e},LGsus:function(n,e,t){return n(e,t)},Wfrxk:e(342)+e(458),cxJZE:function(n,e){return n(e)}};t[e(423)](n[e(293)],"F6")&&t[e(277)](Post,t[e(336)]),t[e(423)](n[e(293)],"F5")&&t[e(277)](Post,t[e(341)]),(t[e(423)](n[e(293)],"G")||t[e(449)](n[e(293)],"g"))&&(n=await t[e(393)](Post,t[e(349)],{id:t[e(277)](parseInt,editingId)}),t[e(308)](setEntityData,n))});export{setDecorateMenu,selectLegacyObject,renderGeometry,showGeometry,hideGeometry,hideTransformControls,cancelRenderGeometry,setEditMode,setRotationSnap,setTranslationSnap,handleUpdatePositions,changeEntity};