const _0x597f4d=_0x2a61;!function(){for(var n=_0x2a61,e=_0x79c7();;)try{if(553616==-parseInt(n(287))*(parseInt(n(189))/2)+parseInt(n(214))/3*(-parseInt(n(245))/4)+parseInt(n(172))/5+parseInt(n(249))/6+parseInt(n(284))/7*(parseInt(n(198))/8)+-parseInt(n(121))/9+parseInt(n(118))/10*(-parseInt(n(223))/11))break;e.push(e.shift())}catch(n){e.push(e.shift())}}();import{Post,getOwnedObjects}from"./api.js";import*as _0x2f86e8 from"three";import{TransformControls}from"three/addons/controls/TransformControls.js";let decorateMenu=null,editable=!1,editingData={};function setDecorateMenu(n){decorateMenu=n}const tracking={x:0,y:0},objectInfos={},furniData={prevY:[],prevX:[],prevZ:[],prevPitch:[],prevRoll:[],prevYaw:[]};let isTransforming=!1,editingId=null;const degToRad=n=>{var e=_0x2a61,t={hFsEp:function(n,e){return n*e},OCWpd:function(n,e){return n/e}};return t[e(186)](n,t[e(263)](Math.PI,180))},radToDeg=n=>{var e=_0x2a61,t={yBiiA:function(n,e){return n*e},teukm:function(n,e){return n/e}};return t[e(131)](n,t[e(197)](180,Math.PI))},selectLegacyObject=async n=>{var e=_0x2a61,t={LLNNi:function(n,e){return n!=e},olesJ:function(n,e){return n==e},qDtZZ:function(n){return n()},ejOLy:function(n,e){return n<e},xrFEi:function(n,e){return n==e},XcDlo:function(n,e){return n!=e}};if(t[e(120)](decorateMenu,null)&&t[e(209)](decorateMenu[e(124)],2)){var r=await t[e(145)](getOwnedObjects);if(!t[e(209)](r[decorateMenu[e(178)][e(266)+"u"][e(173)]][e(248)],n)){for(var a=null,o=0;t[e(301)](o,r[e(234)]);o++)if(t[e(133)](r[o][e(248)],n)){a=o;break}t[e(161)](a,null)&&(decorateMenu[e(178)][e(266)+"u"][e(173)]=a),decorateMenu[e(178)][e(266)+"u"][e(124)]()}}},mouseDownHandler=async n=>{var e=_0x2a61,t={FQKCY:function(n,e){return n&&e},jBtFl:function(n,e){return n!==e},rxFNN:e(143),ZfTLZ:function(n,e,t){return n(e,t)},OLgGn:e(314)+e(299),tNwHp:function(n,e){return n!==e},PduOp:function(n,e){return n!=e},lGCMC:function(n,e){return n==e},jJqwe:function(n){return n()},vXnhQ:function(n,e){return n<e},xaSlV:function(n,e){return n!=e},GOrfL:function(n,e){return n(e)},IzKve:e(254),cxKPC:function(n,e){return n==e}};if(!(isTransforming=!t[e(272)](isTransforming,!editingId)&&isTransforming)&&!t[e(280)](n[e(316)][e(211)],t[e(169)])){var n=tracking.x,r=tracking.y,a=await t[e(219)](Post,t[e(194)],{x:n,y:r});if(a[e(163)]&&t[e(264)](editingId,a[e(164)]))if(t[e(247)](decorateMenu,null)&&t[e(275)](decorateMenu[e(124)],2)){var o=await t[e(217)](getOwnedObjects);if(!t[e(275)](o[decorateMenu[e(178)][e(266)+"u"][e(173)]][e(248)],a[e(164)])){for(var i=null,c=0;t[e(276)](c,o[e(234)]);c++)if(t[e(275)](o[c][e(248)],a[e(164)])){i=c;break}t[e(305)](i,null)&&(decorateMenu[e(178)][e(266)+"u"][e(173)]=i),decorateMenu[e(178)][e(266)+"u"][e(124)]()}}else t[e(217)](clearData),editingId=a[e(164)],t[e(134)](changeEntity,editingId),isTransforming=!1;else if(!a[e(163)]){var s=t[e(122)][e(298)]("|");let n=0;for(;;){switch(s[n++]){case"0":t[e(217)](clearData);continue;case"1":if(t[e(247)](decorateMenu,null)&&t[e(323)](decorateMenu[e(124)],2))return;continue;case"2":transformControls[e(294)]=!1;continue;case"3":isTransforming=!1;continue;case"4":editingId=null;continue}break}}}},handleTracking=(window[_0x597f4d(207)+_0x597f4d(267)](_0x597f4d(200),mouseDownHandler),n=>{var e=_0x597f4d,t={Bqyio:function(n,e){return n-e},fpmcL:function(n,e,t){return n(e,t)},FupBe:function(n,e,t){return n(e,t)}},r=t[e(154)](n[e(271)],n[e(316)][e(300)]),n=t[e(154)](n[e(229)],n[e(316)][e(300)]);tracking.x=t[e(252)](normalize,r,document[e(238)+e(155)][e(270)+"h"]),tracking.y=t[e(216)](normalize,n,document[e(238)+e(155)][e(232)+"ht"])}),Scene=new _0x2f86e8[_0x597f4d(269)],Renderer=new _0x2f86e8[_0x597f4d(135)+_0x597f4d(212)]({alpha:!0}),Camera=(Renderer[_0x597f4d(158)](window[_0x597f4d(283)],window[_0x597f4d(303)+"t"]),document[_0x597f4d(318)+_0x597f4d(170)](_0x597f4d(183))[_0x597f4d(147)+"d"](Renderer[_0x597f4d(233)]),new _0x2f86e8[_0x597f4d(226)+_0x597f4d(192)](50,window[_0x597f4d(283)]/window[_0x597f4d(303)+"t"],.1,1e4));function _0x79c7(){const n=["MHBkp","DxUCV","fpmcL","block","1|0|4|2|3","hjpZe","5|3|4|13|1","QmXJd","y_info","ioKov","zLOsi","ect","keydown","OCWpd","tNwHp","ty-x","sortingMen","stener","HXhYN","Scene","scrollWidt","pageX","FQKCY","prevPitch","attach","lGCMC","vXnhQ","ty-y","BoxGeometr","2|1|0|6|3|","jBtFl","SyBLK","Qewah","innerWidth","70ScqIEC","edit_entit","qtcxG","143107UNKdDw","QJdZD","translate","prevRoll","lRCwG","HvTgj","TnBxE","visible","VtxSo","l-name","position","split","ity","offsetTop","ejOLy","setTransla","innerHeigh","alpha","xaSlV","lper #enti","ygilh","tionSnap","KcHyL","#object-he","wZrjk","exists","EDvht","select_ent","JhMAO","target","fzfZo","querySelec","toggleMous","|0|15|9|7|","5|4","ty-z","cxKPC","bSSBn","MeshPhongM","EsAke","tmrFH","uuHHj","wrMsA","10pOPHAQ","cWnRw","LLNNi","94122tJeTIA","IzKve","KsIck","sort","2|14|10|11","setRotatio","evLVY","lper #mode","ectionMatr","change","yBiiA","roll","xrFEi","GOrfL","WebGLRende","voqJd","eMovement","mousemove","GKyHn","3|5|1|0|2|","set","bOoJL","CANVAS","pIDSE","qDtZZ","XiNbT","appendChil","WbmTc","prevYaw","hash","wJhVS","MvBoG","cam","Bqyio","ement","load_entit","val","setSize","toggleCurs","style","XcDlo","NCajp","hit","entity","TgUzs","OZxrv","ZDnUz","BfZth","rxFNN","tor","none","1699145lDtCrv","stash","Mesh","rotate","MUukV","aterial","categories","yaw","BpYNU","pZvYW","oprkB","#decorate","prevZ","nSnap","hFsEp","updateProj","ground_obj","2ExwMSx","prevX","pitch","eCamera","JYBTH","OLgGn","lLfXF","order","teukm","777176gGwxrl","XvvLc","mousedown","SAaSt","SSJRF","oIMUa","MKtrG","tFuOP","key","addEventLi","add","olesJ","6|8|1|2","tagName","rer","lArdS","1117647UAaJmG","display","FupBe","jJqwe","push","ZfTLZ","xJtPd","ytUmj","setMode","14324552yjkGyC","ty-yaw","sqxXI","Perspectiv","rotation","snSzj","pageY","mouseUp","ty-pitch","scrollHeig","domElement","length","mouseDown","QTLqf","1|0|3|2|4|","documentEl","render","fov","YZX","ty-roll","distance","scale","4udikDz","prevY","PduOp","handle","6423978fvqOMS"];return(_0x79c7=function(){return n})()}function _0x2a61(n,e){const t=_0x79c7();return(_0x2a61=function(n,e){return n-=115,t[n]})(n,e)}Camera[_0x597f4d(227)][_0x597f4d(196)]=_0x597f4d(241);const boxGeometry=new _0x2f86e8[_0x597f4d(278)+"y"](1,1,1),meshPhongMaterial=new _0x2f86e8[_0x597f4d(325)+_0x597f4d(177)]({color:16711935,transparent:!0,opacity:0}),Mesh=new _0x2f86e8[_0x597f4d(174)](boxGeometry,meshPhongMaterial);Mesh[_0x597f4d(227)][_0x597f4d(196)]=_0x597f4d(241),Mesh[_0x597f4d(244)][_0x597f4d(141)](1,1,1),Scene[_0x597f4d(208)](Mesh),Renderer[_0x597f4d(233)][_0x597f4d(160)][_0x597f4d(215)]=_0x597f4d(171);let animationFrameActive=null;function renderGeometry(){var n=_0x597f4d;animationFrameActive={xJtPd:function(n,e){return n(e)}}[n(220)](requestAnimationFrame,renderGeometry),Renderer[n(239)](Scene,Camera)}function showGeometry(){var n=_0x597f4d,e={HvTgj:n(253)};transformControls[n(294)]=!1,Renderer[n(233)][n(160)][n(215)]=e[n(292)]}function hideGeometry(){var n=_0x597f4d,e={NCajp:n(171)};transformControls[n(294)]=!1,Renderer[n(233)][n(160)][n(215)]=e[n(162)]}function hideTransformControls(){var n=_0x597f4d;transformControls[n(294)]=!1}const transformControls=new TransformControls(Camera,Renderer[_0x597f4d(233)]),editEntity=(transformControls[_0x597f4d(207)+_0x597f4d(267)](_0x597f4d(130),()=>{var n=_0x597f4d,e={QJdZD:function(n,e){return n(e)},lLfXF:function(n,e){return n(e)},BfZth:function(n,e){return n(e)},DxUCV:function(n){return n()}},t=objectInfos[editingId];Mesh[n(297)].x&&Mesh[n(297)].y&&Mesh[n(297)].z&&t&&(t.x=Mesh[n(297)].x,t.y=-Mesh[n(297)].z,t.z=Mesh[n(297)].y,t[n(191)]=e[n(288)](radToDeg,Mesh[n(227)].x),t[n(132)]=e[n(195)](radToDeg,-Mesh[n(227)].z),t[n(179)]=e[n(168)](radToDeg,Mesh[n(227)].y),e[n(251)](editEntity),Renderer[n(239)](Scene,Camera))}),()=>{var n=_0x597f4d,e={XvvLc:function(n,e,t){return n(e,t)},SSJRF:n(285)+"y",EsAke:function(n,e){return n(e)},evLVY:function(n,e){return n(e)},lArdS:function(n,e){return n(e)},SyBLK:function(n,e){return n(e)}},t=objectInfos[editingId];e[n(199)](Post,e[n(202)],{id:editingId,alpha:e[n(326)](parseInt,t[n(304)]),x:e[n(127)](parseFloat,t.x),y:e[n(326)](parseFloat,t.y),z:e[n(326)](parseFloat,t.z),pitch:e[n(213)](parseFloat,t[n(191)]),roll:e[n(213)](parseFloat,t[n(132)]),yaw:e[n(326)](parseFloat,t[n(179)])}),e[n(281)](setObjectHelperValues,t)}),storeData=(transformControls[_0x597f4d(207)+_0x597f4d(267)](_0x597f4d(235),()=>{var n=_0x597f4d;isTransforming=!0,{MHBkp:function(n){return n()}}[n(250)](storeData)}),transformControls[_0x597f4d(207)+_0x597f4d(267)](_0x597f4d(230),()=>{var n=_0x597f4d,e=objectInfos[editingId];e&&(e.x=Mesh[n(297)].x,e.y=-Mesh[n(297)].z,e.z=Mesh[n(297)].y,isTransforming=!1)}),transformControls[_0x597f4d(302)+_0x597f4d(308)](.1),transformControls[_0x597f4d(158)](.8),transformControls[_0x597f4d(126)+_0x597f4d(185)](degToRad(15)),transformControls[_0x597f4d(274)](Mesh),Scene[_0x597f4d(208)](transformControls),()=>{var e=_0x597f4d,t={ytUmj:function(n,e){return n!==e},WbmTc:function(n,e){return n!==e},GKyHn:e(237)+"5"},r=objectInfos[editingId];if(r&&t[e(221)](r.x,0)&&t[e(148)](r.y,0)&&t[e(148)](r.z,0)){var a=t[e(139)][e(298)]("|");let n=0;for(;;){switch(a[n++]){case"0":furniData[e(246)][e(218)](r.y);continue;case"1":furniData[e(190)][e(218)](r.x);continue;case"2":furniData[e(273)][e(218)](r[e(191)]);continue;case"3":furniData[e(184)][e(218)](r.z);continue;case"4":furniData[e(290)][e(218)](r[e(132)]);continue;case"5":furniData[e(149)][e(218)](r[e(179)]);continue}break}}});function cancelRenderGeometry(){var n=_0x597f4d;animationFrameActive&&({cWnRw:function(n,e){return n(e)}}[n(119)](cancelAnimationFrame,animationFrameActive),animationFrameActive=null)}function setEditMode(n){var e=_0x597f4d,t={JYBTH:function(n,e){return n===e},oprkB:e(175),EDvht:e(289)};t[e(193)](n,t[e(182)])?transformControls[e(222)](t[e(182)]):transformControls[e(222)](t[e(313)])}function setRotationSnap(n){var e=_0x597f4d;transformControls[e(126)+e(185)](n)}function setTranslationSnap(n){var e=_0x597f4d;transformControls[e(302)+e(308)](n)}const normalize=(n,e)=>{var t=_0x597f4d,r={tmrFH:function(n,e){return n+e},zLOsi:function(n,e){return n/e},JhMAO:function(n,e){return n*e},MKtrG:function(n,e){return n-e},wZrjk:function(n,e){return n-e}};return r[t(115)](r[t(260)](r[t(315)](1,r[t(204)](n,0)),r[t(311)](e,0)),0)},handleUpdatePositions=(window[_0x597f4d(207)+_0x597f4d(267)](_0x597f4d(138),handleTracking),n=>{var e=_0x597f4d,t={QmXJd:function(n,e){return n(e)},pZvYW:function(n,e,t){return n(e,t)},BpYNU:function(n,e){return n(e)}},r=(Camera[e(297)][e(141)](n[e(153)][e(297)].x,n[e(153)][e(297)].z,-n[e(153)][e(297)].y),n[e(153)][e(227)].x),a=n[e(153)][e(227)].z,o=n[e(153)][e(227)].y;Camera[e(227)][e(141)](t[e(257)](degToRad,r),t[e(257)](degToRad,t[e(181)](zRotationHandler,r,a)),t[e(257)](degToRad,o)),Camera[e(240)]=n[e(153)][e(240)],Camera[e(187)+e(129)+"ix"](),n[e(164)][e(297)]&&(Mesh[e(297)][e(141)](n[e(164)][e(297)].x,n[e(164)][e(297)].z,-n[e(164)][e(297)].y),Mesh[e(227)][e(141)](t[e(257)](degToRad,n[e(164)][e(227)].x),t[e(257)](degToRad,n[e(164)][e(227)].z),t[e(180)](degToRad,-n[e(164)][e(227)].y)))}),changeEntity=async n=>{var e=_0x597f4d,t={hjpZe:function(n,e,t){return n(e,t)},tFuOP:e(156)+e(258),MUukV:function(n,e){return n(e)}},n=await t[e(255)](Post,t[e(205)],{id:t[e(176)](parseInt,n)});t[e(176)](setEntityData,n)},zRotationHandler=(n,e)=>{var t=_0x597f4d,r={SAaSt:function(n,e){return e<n},KcHyL:function(n,e){return n<e},fzfZo:function(n,e){return e<n}};return(!r[t(201)](n,0)||!r[t(309)](n,90))&&(r[t(317)](n,-180)&&r[t(309)](n,-90)||r[t(317)](n,0))?-e:e},setEntityData=n=>{var e=_0x597f4d,t={KsIck:e(256)+e(125)+e(320)+e(210),XiNbT:function(n,e){return n(e)},TgUzs:function(n,e){return n!==e},sqxXI:function(n){return n()}},r=t[e(123)][e(298)]("|");let a=0;for(;;){switch(r[a++]){case"0":editingData.y=n.y;continue;case"1":transformControls[e(294)]=!0;continue;case"2":t[e(146)](setObjectHelperValues,n);continue;case"3":t[e(165)](editingId,n.id)&&t[e(225)](clearData);continue;case"4":editable=!0;continue;case"5":if(n[e(312)])continue;return editable=!1,void(transformControls[e(294)]=!1);case"6":editingData[e(179)]=n[e(179)];continue;case"7":editingData[e(132)]=n[e(132)];continue;case"8":editingData[e(243)]=n[e(243)];continue;case"9":editingData[e(191)]=n[e(191)];continue;case"10":editingData[e(304)]=n[e(304)];continue;case"11":editingData.x=n.x;continue;case"12":objectInfos[editingId]={id:n.id,hash:n[e(150)],alpha:n[e(304)],x:n.x,y:n.y,z:n.z,pitch:n[e(191)],roll:n[e(132)],yaw:n[e(179)],distance:n[e(243)],quaternion:{}};continue;case"13":editingId=n.id;continue;case"14":editingData[e(150)]=n[e(150)];continue;case"15":editingData.z=n.z;continue}break}},setObjectHelperValues=n=>{var e=_0x597f4d,t={bSSBn:e(279)+e(321),Qewah:function(n,e){return n(e)},wrMsA:e(310)+e(306)+e(277),uuHHj:e(310)+e(306)+e(265),oIMUa:function(n,e){return n(e)},lRCwG:e(310)+e(128)+e(296),ioKov:e(310)+e(306)+e(231),bOoJL:function(n,e){return n(e)},qtcxG:e(310)+e(306)+e(224),voqJd:e(310)+e(306)+e(242),VtxSo:e(310)+e(306)+e(322)},r=t[e(324)][e(298)]("|");let a=0;for(;;){switch(r[a++]){case"0":t[e(282)]($,t[e(117)])[e(157)](n.y);continue;case"1":t[e(282)]($,t[e(116)])[e(157)](n.x);continue;case"2":t[e(203)]($,t[e(291)])[e(157)](n[e(150)]);continue;case"3":t[e(282)]($,t[e(259)])[e(157)](n[e(191)]);continue;case"4":t[e(142)]($,t[e(286)])[e(157)](n[e(179)]);continue;case"5":t[e(203)]($,t[e(136)])[e(157)](n[e(132)]);continue;case"6":t[e(142)]($,t[e(295)])[e(157)](n.z);continue}break}},clearData=()=>{var n=_0x597f4d,e={pIDSE:n(140)+"4"}[n(144)][n(298)]("|");let t=0;for(;;){switch(e[t++]){case"0":furniData[n(273)]=[];continue;case"1":furniData[n(184)]=[];continue;case"2":furniData[n(290)]=[];continue;case"3":furniData[n(246)]=[];continue;case"4":furniData[n(149)]=[];continue;case"5":furniData[n(190)]=[];continue}break}};window[_0x597f4d(207)+_0x597f4d(267)](_0x597f4d(262),async n=>{var e=_0x597f4d,t={ygilh:function(n,e){return n===e},HXhYN:function(n,e){return n(e)},snSzj:e(319)+e(137),TnBxE:function(n,e){return n(e)},MvBoG:e(159)+"or",wJhVS:function(n,e,t){return n(e,t)},QTLqf:e(188)+e(261),ZDnUz:function(n,e){return n(e)},OZxrv:function(n,e){return n(e)}};t[e(307)](n[e(206)],"F6")&&t[e(268)](Post,t[e(228)]),t[e(307)](n[e(206)],"F5")&&t[e(293)](Post,t[e(152)]),(t[e(307)](n[e(206)],"G")||t[e(307)](n[e(206)],"g"))&&(n=await t[e(151)](Post,t[e(236)],{id:t[e(167)](parseInt,editingId)}),t[e(166)](setEntityData,n))});export{setDecorateMenu,selectLegacyObject,renderGeometry,showGeometry,hideGeometry,hideTransformControls,cancelRenderGeometry,setEditMode,setRotationSnap,setTranslationSnap,handleUpdatePositions,changeEntity};